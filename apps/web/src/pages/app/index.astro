---
import BaseLayout from '../../layouts/BaseLayout.astro';
import SubscriptionsApp from '../../components/graphql/SubscriptionsApp';
import { isAuthReady, isApiReady } from '../../lib/flags';

const authReady = isAuthReady();
const apiReady = isApiReady();
---

<BaseLayout title="Subscriptions" description="Your podcast subscriptions.">
  <section class="mx-auto flex max-w-5xl flex-col gap-10 px-6 py-16 md:py-24">
    <div class="space-y-3 text-center md:text-left">
      <p class="text-xs uppercase tracking-[0.4em] text-brand-muted">Dashboard</p>
      <h1 class="text-3xl font-semibold text-brand-text">Your Subscriptions</h1>
      <p class="text-sm text-brand-muted">
        Data loads directly from AppSync using your Cognito session. Subscriptions update in near real-time when
        refresh jobs run.
      </p>
    </div>

    {authReady && apiReady ? (
      <SubscriptionsApp client:only="react" />
    ) : (
      <div class="rounded-xl border border-brand-primary/30 bg-brand-surface/60 p-8 text-center text-sm text-brand-muted">
        {authReady
          ? 'API is not enabled yet. Check back soon for subscriptions.'
          : 'Authentication is disabled. Enable auth to view subscriptions.'}
      </div>
    )}
  </section>
</BaseLayout>
